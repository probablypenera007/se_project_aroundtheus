!function(){"use strict";const e={inputSelector:".modal__input",submitButtonSelector:".modal__button_submit",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",formSelector:".modal__form"},t=[...document.querySelectorAll(e.formSelector)],s=(document.querySelectorAll(".modal"),document.querySelector("#profile-button-edit")),o=document.querySelector("#modal-edit-profile"),n=(o.querySelector("#modal-edit-button-close"),document.querySelector(".profile__name"),document.querySelector(".profile__subtitle"),document.querySelector("#edit-name"),document.querySelector("#edit-bio"),o.querySelector("#modal-form-edit"),document.querySelector("#profile-button-add")),r=document.querySelector("#modal-add-profile"),i=r.querySelector("#add-modal-form"),a=(r.querySelector("#modal-button-close-add"),i.querySelector("#add-title"),i.querySelector("#add-imageURL"),document.querySelector("#modal-previewImage"));document.querySelector(".modal__previewImage"),document.querySelector("#preview-title"),a.querySelector("#modal-button-close-preview"),document.querySelector("#modal-button-create"),document.querySelector("#modal-button-save"),document.querySelector(".cards__content"),document.querySelector("#card-template").content.firstElementChild.cloneNode(!0);class l{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputElements=Array.from(t.querySelectorAll(this._inputSelector)),this._submitButton=t.querySelector(this._submitButtonSelector)}_showInputError(e,t){e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e,t){const s=e.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),s.textContent=" ",s.classList.remove(this._errorClass)}_checkInputValidity(e,t){t.validity.valid?this._hideInputError(e,t):this._showInputError(t,e.querySelector(`#${t.id}-error`))}_checkFormValidity=()=>this._inputElements.every((e=>e.validity.valid));resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(this._form,e)}))}toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(this._form,e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this.setEventListeners()}}class c{constructor(e,t,s){let{name:o,link:n}=e;this._name=o,this._link=n,this._cardSelector=t,this._handleCardClick=s}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleHeartButton()})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleTrashButton()})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}_handleHeartButton(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleTrashButton(){this._cardElement.remove(),this._cardElement=null}_getElement(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCardElement(){this._cardElement=this._getElement();const e=this._cardElement.querySelector(".card__title"),t=this._cardElement.querySelector(".card__image");return t.src=this._link,t.alt=this._name,e.textContent=this._name,this._setEventListeners(),this._cardElement}}class u{constructor(e){this._popupElement=document.querySelector(e),this._closeByEscape=this._closeByEscape.bind(this),this._closeOverlaybyClick=this._closeOverlaybyClick.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._closeByEscape),this._popupElement.addEventListener("mousedown",this._closeOverlaybyClick)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._closeByEscape),this._popupElement.removeEventListener("mousedown",this._closeOverlaybyClick)}_closeByEscape=e=>{"Escape"===e.key&&this.close()};_closeOverlaybyClick(e){e.target.classList.contains("modal_opened")&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__button-close"))&&this.close()}))}}class d extends u{constructor(e,t){super(e),this._popForm=this._popupElement.querySelector(".modal__form"),this._popSubmitBtn=this._popForm.querySelector(".modal__button_submit"),this._popInputs=this._popForm.querySelectorAll(".modal__input"),this._handleFormSubmit=t}_getInputValues(){const e={};return this._popInputs.forEach((t=>{e[t.name]=t.value})),e}_handleSubmit(e){e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t),this.close()}setEventListeners(){super.setEventListeners(),this._popForm.addEventListener("submit",this._handleSubmit.bind(this))}setInputValues(e){this._popInputs.forEach((t=>{e[t.name]&&(t.value=e[t.name])}))}close(){this._popForm.reset(),super.close()}}const m={},_=new class{constructor(e,t){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.job}}(".profile__name",".profile__subtitle");function h(e){return new c(e,"#card-template",v).getCardElement()}const p=new class{constructor(e,t){let{items:s,renderer:o}=e;this._items=s,this._renderer=o,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=h(e);p.addItem(t)}},".cards__content");p.renderItems();const E=new class extends u{constructor(e){super(e),this._image=this._popupElement.querySelector(".modal__previewImage"),this._caption=this._popupElement.querySelector("#preview-title")}open(e){super.open(),e&&(this._image.src=e.link,this._image.alt=e.name,this._caption.textContent=e.name)}}("#modal-previewImage");E.setEventListeners();const y=new d("#modal-edit-profile",(e=>{_.setUserInfo(e),y.close()}));y.setEventListeners();const S=new d("#modal-add-profile",(e=>{!function(e,t){const s=h({name:e,link:t});p.addItem(s),S.close()}(e.name,e.link)}));function v(e){E.open(e)}S.setEventListeners(),(e=>{t.forEach((t=>{const s=new l(e,t),o=t.getAttribute("name");m[o]=s,s.enableValidation()}))})(e),s.addEventListener("click",(()=>{const e=_.getUserInfo();m["modal-edit-form"].resetValidation(),y.setInputValues(e),y.open()})),n.addEventListener("click",(()=>{m["modal-add-form"].resetValidation(),S.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBTTRCLEVBQUsxQyxLQUN2QjNDLEtBQUtpSCxPQUFPdkQsSUFBTTJCLEVBQUszQyxLQUN2QjFDLEtBQUtrSCxTQUFTbEcsWUFBY3FFLEVBQUszQyxLQUVyQyxHSDRCd0MsdUJBQzFDcUUsRUFBZTlFLG9CQUVmLE1BQU1rRixFQUFtQixJQUFJNUMsRUFDM0IsdUJBQ0M2QyxJQUNDNUIsRUFBU08sWUFBWXFCLEdBQ3JCRCxFQUFpQmpELE9BQU8sSUFHNUJpRCxFQUFpQmxGLG9CQUVqQixNQUFNb0YsRUFBZSxJQUFJOUMsRUFBYyxzQkFBdUI2QyxLQVE5RCxTQUFvQ0UsRUFBTzNFLEdBQ3pDLE1BQU00RSxFQUFVdkIsRUFBVyxDQUFFdEQsS0FBTTRFLEVBQU8zRSxTQUMxQ3dELEVBQVFRLFFBQVFZLEdBQ2hCRixFQUFhbkQsT0FDZixDQVRFc0QsQ0FGYUosRUFBUzFFLEtBQ1QwRSxFQUFTekUsS0FDZ0IsSUFVeEMsU0FBU3VELEVBQWlCYixHQUN4QjBCLEVBQWU5QyxLQUFLb0IsRUFDdEIsQ0FWQWdDLEVBQWFwRixvQkFqRGF4RCxLQUN4QmdKLEVBQUFBLFNBQXNCMUgsSUFDcEIsTUFBTTJILEVBQVksSUFBSTdILEVBQWNwQixFQUFVc0IsR0FDeEM0SCxFQUFXNUgsRUFBWTZILGFBQWEsUUFDMUNyQyxFQUFlb0MsR0FBWUQsRUFDNUJBLEVBQVV2RixrQkFBa0IsR0FDM0IsRUFzREpBLENBQWlCMUQsR0FHakJnSixFQUFBQSxpQkFBdUMsU0FBUyxLQUM5QyxNQUFNTCxFQUFXNUIsRUFBU0ssY0FDMUJOLEVBQWUsbUJBQW1CM0Qsa0JBQ2xDdUYsRUFBaUIvQixlQUFlZ0MsR0FDaENELEVBQWlCbEQsTUFBTSxJQUd6QndELEVBQUFBLGlCQUFzQyxTQUFTLEtBQzdDbEMsRUFBZSxrQkFBa0IzRCxrQkFDakN5RixFQUFhcEQsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbnN0YW50cy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2RvbS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wVXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wVXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3BVcFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbIC8vIGluaXRpYWwgYXJyYXkgb2YgY2FyZHNcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dOyBcblxuXG5cbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgICAvL3ZhbGlkYXRpb24gc2V0dGluZ3MgZm9yIHRoZSBmb3JtIHZhbGlkYXRvclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uX3N1Ym1pdFwiLFxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbiAgICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIH07XG5cbmV4cG9ydCBjb25zdCB1c2VySW5mb1NldHRpbmdzID0ge1xuICB1c2VyTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIGpvYk5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcbn1cblxuIiwiaW1wb3J0IHtzZXR0aW5nc30gZnJvbSBcIi4uL2NvbnN0YW50cy9jb25zdGFudHMuanNcIlxuLy9leHBvcnQgY29uc3QgbW9kYWxGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBmb3JtTGlzdCA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcildXG5leHBvcnQgY29uc3QgbW9kYWxzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIildOyAvL2dldCBhbGwgbW9kYWwgY29udGFpbmVyc1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVCdXR0b25FZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWJ1dHRvbi1lZGl0XCIpOyAvL3Byb2ZpbGUgZWRpdCBidXR0b25cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0LXByb2ZpbGVcIik7IC8vcHJvZmlsZSBlZGl0IG1vZGFsXG5leHBvcnQgY29uc3QgcHJvZmlsZUJ1dHRvbkNsb3NlID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKCAvL3Byb2ZpbGUgZWRpdCBtb2RhbCBjbG9zZSBidXR0b25cbiAgXCIjbW9kYWwtZWRpdC1idXR0b24tY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTsgLy9wcm9maWxlIG5hbWUgZWxlbWVudFxuZXhwb3J0IGNvbnN0IHByb2ZpbGVCaW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpOyAvLyBwcm9maWxlIGJpbyBlbGVtZW50XG5leHBvcnQgY29uc3QgcHJvZmlsZUN1cnJlbnROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW5hbWVcIik7IC8vIHByb2ZpbGUgY3VycmVudCBuYW1lIGlucHV0XG5leHBvcnQgY29uc3QgcHJvZmlsZUN1cnJlbnRCaW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtYmlvXCIpOyAvLyBwcm9maWxlIGN1cnJlbnQgYmlvIGlucHV0XG5leHBvcnQgY29uc3QgcHJvZmlsZUZvcm1FZGl0ID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWZvcm0tZWRpdFwiKTsgLy8gcHJvZmlsZSBlZGl0IGZvcm1cblxuLypBREQgRUxFTUVOVFMgKi9cbmV4cG9ydCBjb25zdCBwcm9maWxlQnV0dG9uQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWJ1dHRvbi1hZGRcIik7Ly8gcHJvZmlsZSBhZGQgYnV0dG9uXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1hZGQtcHJvZmlsZVwiKTsgLy8gcHJvZmlsZSBhZGQgbW9kYWxcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybUFkZCA9IHByb2ZpbGVBZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1tb2RhbC1mb3JtXCIpOyAvL3Byb2ZpbGUgYWRkIGZvcm1cbmV4cG9ydCBjb25zdCBwcm9maWxlQnV0dG9uQ2xvc2VBZGQgPSBwcm9maWxlQWRkTW9kYWwucXVlcnlTZWxlY3RvciggLy8gcHJvZmlsZSBhZGQgbW9kYWwgY2xvc2UgYnV0dG9uXG4gIFwiI21vZGFsLWJ1dHRvbi1jbG9zZS1hZGRcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkSW1hZ2VUaXRsZSA9IHByb2ZpbGVGb3JtQWRkLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLXRpdGxlXCIpOyAvL3Byb2ZpbGUgYWRkIGltYWdlIHRpdGxlXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEltYWdlTGluayA9IHByb2ZpbGVGb3JtQWRkLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWltYWdlVVJMXCIpOyAvLyBwcnRvZmlsZSBhZGQgaW1hZ2UgbGlua1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1wcmV2aWV3SW1hZ2VcIik7IC8vcHJldmlldyBpbWFnZSBtb2RhbFxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXdJbWFnZVwiKTsgLy9nZXQgcHJldmlldyBpbWFnZSBlbGVtZW50XG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctdGl0bGVcIik7IC8vZ2V0IHByZXZpZXcgaW1hZ2UgdGl0bGUgZWxlbWVudFxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsQ2xvc2UgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKCAvL3ByZXZpZXcgaW1hZ2UgbW9kYWwgY2xvc2UgYnV0dG9uXG4gIFwiI21vZGFsLWJ1dHRvbi1jbG9zZS1wcmV2aWV3XCJcbik7XG5leHBvcnQgY29uc3QgYWRkU3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1idXR0b24tY3JlYXRlXCIpO1xuZXhwb3J0IGNvbnN0IGVkaXRTdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWJ1dHRvbi1zYXZlXCIpO1xuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2NvbnRlbnRcIik7IC8vIGNhcmQgY29udGVudCBjb250YWluZXJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudCAgLy8gY2xvbmVkIGNhcmQgdGVtcGxhdGVcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKVxuICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHsgXG5cbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7IFxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yOyBcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yOyBcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzczsgXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzOyBcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzczsgXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50OyBcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gQXJyYXkuZnJvbSggXG4gICAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpIFxuICAgICk7IFxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpOyBcbiAgfSBcbiBcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwsIGVycm9yTWVzc2FnZUVsbSkgeyBcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTsgXG4gICAgZXJyb3JNZXNzYWdlRWxtLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTsgXG4gICAgZXJyb3JNZXNzYWdlRWxtLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7IFxuICB9IFxuXG4gIF9oaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwpIHsgXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxtID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7IFxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpOyBcbiAgICBlcnJvck1lc3NhZ2VFbG0udGV4dENvbnRlbnQgPSBcIiBcIjsgXG4gICAgZXJyb3JNZXNzYWdlRWxtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7IFxuICB9IFxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsKSB7IFxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkgeyBcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKCBcbiAgICAgICAgaW5wdXRFbCwgXG4gICAgICAgIGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApIFxuICAgICAgKTsgXG4gICAgfSBlbHNlIHsgXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwpOyBcbiAgICB9IFxuICB9IFxuXG4gIF9jaGVja0Zvcm1WYWxpZGl0eSA9ICgpID0+IHsgXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkoIFxuICAgICAgKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCBcbiAgICApOyBcbiAgfTsgXG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKHRoaXMuX2Zvcm0sIGlucHV0RWxlbWVudCkgXG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHsgXG4gICAgY29uc3QgaXNGb3JtVmFsaWQgPSB0aGlzLl9jaGVja0Zvcm1WYWxpZGl0eSgpOyBcbiAgICBpZiAoaXNGb3JtVmFsaWQpIHsgXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTsgXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTsgXG4gICAgfSBlbHNlIHsgXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTsgXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlOyBcbiAgICB9IFxuICB9IFxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkgeyBcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4geyBcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4geyBcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KHRoaXMuX2Zvcm0sIGlucHV0RWxlbWVudCk7IFxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IFxuICAgICAgfSk7IFxuICAgIH0pOyBcbiAgfSBcblxuICBlbmFibGVWYWxpZGF0aW9uKCkgeyBcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4geyBcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOyBcbiAgICB9KTsgXG4gICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpOyBcbiAgfSBcbn0gIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgbGluayB9LCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaykge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlSGVhcnRCdXR0b24oKTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVUcmFzaEJ1dHRvbigpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xuICAgICAgfSk7XG4gIH1cblxuICBfaGFuZGxlSGVhcnRCdXR0b24oKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXG4gICAgICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfVxuXG4gIF9oYW5kbGVUcmFzaEJ1dHRvbigpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfZ2V0RWxlbWVudCgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuXG4gIGdldENhcmRFbGVtZW50KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0RWxlbWVudCgpO1xuICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcblxuICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIGNhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cblxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCeUVzY2FwZSA9IHRoaXMuX2Nsb3NlQnlFc2NhcGUuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9jbG9zZU92ZXJsYXlieUNsaWNrID0gdGhpcy5fY2xvc2VPdmVybGF5YnlDbGljay5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9jbG9zZUJ5RXNjYXBlKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9jbG9zZU92ZXJsYXlieUNsaWNrKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2Nsb3NlQnlFc2NhcGUpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2Nsb3NlT3ZlcmxheWJ5Q2xpY2spO1xuICB9XG5cbiAgX2Nsb3NlQnlFc2NhcGUgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgX2Nsb3NlT3ZlcmxheWJ5Q2xpY2soZXZ0KSB7XG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSAge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCl7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpfHwgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fYnV0dG9uLWNsb3NlXCIpKVxuICAgICAge1xuICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLy9hZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGNsb3NpbmcgcG9wdXBzIGJ5IEVzYyBrZXlcbiAgLy9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZ0KSA9PiB7XG4gIC8vICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAvLyAgICBjb25zdCBvcGVuZWRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAvLyAgICBpZiAob3BlbmVkUG9wdXApIHtcbiAgLy8gICAgICBwb3BVcFdpdGhJbWFnZS5jbG9zZSgpO1xuICAvLyAgICAgIHBvcFVwRWRpdFByb2ZpbGUuY2xvc2UoKTtcbiAgLy8gICAgICBwb3BVcEFkZEl0ZW0uY2xvc2UoKTtcbiAgLy8gICAgfVxuICAvLyAgfVxuICAvL30pO1xuXG4gIC8vQWRkIGV2ZW50IGxpc3RlbmVycyBmb3IgY2xvc2luZyBwb3B1cHMgY2xpY2tpbmcgb3V0c2lkZVxuICAvL0RPTS5tb2RhbHMuZm9yRWFjaCgobW9kYWxDb250YWluZXIpID0+IHtcbiAgLy8gIG1vZGFsQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAvLyAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAvLyAgICAgcG9wVXBXaXRoSW1hZ2UuY2xvc2UoKTtcbiAgLy8gICAgIHBvcFVwRWRpdFByb2ZpbGUuY2xvc2UoKTtcbiAgLy8gICAgIHBvcFVwQWRkSXRlbS5jbG9zZSgpO1xuICAvLyAgIH1cblxuICAvLyBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fYnV0dG9uLWNsb3NlXCIpKSB7XG4gIC8vICAgcG9wVXBXaXRoSW1hZ2UuY2xvc2UoKTtcbiAgLy8gICBwb3BVcEVkaXRQcm9maWxlLmNsb3NlKCk7XG4gIC8vICAgcG9wVXBBZGRJdGVtLmNsb3NlKCk7XG4gIC8vIH1cbiAgLy99KTtcbiAgLy8vfSk7XG59XG4iLCJpbXBvcnQgUG9wVXAgZnJvbSBcIi4vUG9wVXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wVXBXaXRoRm9ybSBleHRlbmRzIFBvcFVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9wb3BTdWJtaXRCdG4gPSB0aGlzLl9wb3BGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvbl9zdWJtaXRcIik7XG4gICAgdGhpcy5fcG9wSW5wdXRzID0gdGhpcy5fcG9wRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBwb3BJbnBWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9wb3BJbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHBvcElucFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBwb3BJbnBWYWx1ZXM7XG4gIH1cblxuICBfaGFuZGxlU3VibWl0KGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOyBcbiAgICBjb25zdCBpbnB1dFZhbHVlID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0VmFsdWUpO1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdC5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICBcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX3BvcElucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICBpZiAoZGF0YSBbaW5wdXQubmFtZV0pIHtcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICAgfVxuICAgIH0pO1xuICB9XG5cbiBjbG9zZSgpIHtcbiAgIHRoaXMuX3BvcEZvcm0ucmVzZXQoKTtcbiAgIHN1cGVyLmNsb3NlKCk7XG4gfVxufSIsImltcG9ydCAqIGFzIERPTSBmcm9tIFwiLi4vdXRpbHMvZG9tLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wVXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wVXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3BVcFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcFVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCB7IGluaXRpYWxDYXJkcywgc2V0dGluZ3MgfSBmcm9tIFwiLi4vY29uc3RhbnRzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcblxuLy9Gb3JtIFZhbGlkYXRvcnNcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge31cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoc2V0dGluZ3MpID0+IHtcbiAgRE9NLmZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KVxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJylcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5cbi8vVXNlciBJbmZvXG5jb25zdCB1c2VyaW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX19uYW1lXCIsIFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpO1xuXG4vL0NhcmRcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKGl0ZW0sIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlSW1hZ2VDbGljayk7XG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRDYXJkRWxlbWVudCgpO1xufVxuXG4vL1NlY3Rpb25cbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG4gICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgIH0sXG4gIH0sXG4gIFwiLmNhcmRzX19jb250ZW50XCJcbik7XG5zZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG5cbi8vUG9wdXBzXG5jb25zdCBwb3BVcFdpdGhJbWFnZSA9IG5ldyBQb3BVcFdpdGhJbWFnZShcIiNtb2RhbC1wcmV2aWV3SW1hZ2VcIik7XG5wb3BVcFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3BVcEVkaXRQcm9maWxlID0gbmV3IFBvcFVwV2l0aEZvcm0oXG4gIFwiI21vZGFsLWVkaXQtcHJvZmlsZVwiLFxuICAoZm9ybURhdGEpID0+IHtcbiAgICB1c2VyaW5mby5zZXRVc2VySW5mbyhmb3JtRGF0YSk7XG4gICAgcG9wVXBFZGl0UHJvZmlsZS5jbG9zZSgpO1xuICB9XG4pO1xucG9wVXBFZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3BVcEFkZEl0ZW0gPSBuZXcgUG9wVXBXaXRoRm9ybShcIiNtb2RhbC1hZGQtcHJvZmlsZVwiLCAoZm9ybURhdGEpID0+IHtcbiAgY29uc3QgbmFtZSA9IGZvcm1EYXRhLm5hbWU7XG4gIGNvbnN0IGxpbmsgPSBmb3JtRGF0YS5saW5rO1xuICBoYW5kbGVBZGRQcm9maWxlRm9ybVN1Ym1pdChuYW1lLCBsaW5rKTtcbn0pO1xucG9wVXBBZGRJdGVtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vRXZlbnQgSGFuZGxlcnNcbmZ1bmN0aW9uIGhhbmRsZUFkZFByb2ZpbGVGb3JtU3VibWl0KHRpdGxlLCBsaW5rKSB7XG4gIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKHsgbmFtZTogdGl0bGUsIGxpbmsgfSk7XG4gIHNlY3Rpb24uYWRkSXRlbShuZXdDYXJkKTtcbiAgcG9wVXBBZGRJdGVtLmNsb3NlKCk7XG59XG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGRhdGEpIHtcbiAgcG9wVXBXaXRoSW1hZ2Uub3BlbihkYXRhKTtcbn1cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuXG4vLyBBZGQgRXZlbnQgTGlzdGVuZXJzXG5ET00ucHJvZmlsZUJ1dHRvbkVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgZm9ybURhdGEgPSB1c2VyaW5mby5nZXRVc2VySW5mbygpO1xuICBmb3JtVmFsaWRhdG9yc1tcIm1vZGFsLWVkaXQtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgcG9wVXBFZGl0UHJvZmlsZS5zZXRJbnB1dFZhbHVlcyhmb3JtRGF0YSk7XG4gIHBvcFVwRWRpdFByb2ZpbGUub3BlbigpO1xufSk7XG5cbkRPTS5wcm9maWxlQnV0dG9uQWRkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW1wibW9kYWwtYWRkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcFVwQWRkSXRlbS5vcGVuKCk7XG59KTtcblxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7IC8vcmVwc29uc2libGUgZm9yIHJlbmRlcmluZyBpbmZvcm1hdGlvbiBmcm9tIHRoZSB1c2VyXG4gICAgY29uc3RydWN0b3IodXNlck5hbWVTZWxlY3Rvciwgam9iTmFtZVNlbGVjdG9yKXsvL29iamVjdCB3aXRoIHNlbGVjdG9ycyBvZiB0d28gZWxlbWVudHNcbiAgICAgICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JOYW1lU2VsZWN0b3IpO1xuICAgIH1cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgY29uc3QgdXNlcklucHV0ID0ge1xuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB1c2VySW5wdXQ7XG4gICAgfVxuICAgIFxuICAgIHNldFVzZXJJbmZvKGRhdGEpe1xuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEuam9iO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9ue1xuICAgIGNvbnN0cnVjdG9yKHtpdGVtcywgcmVuZGVyZXJ9LCBjb250YWluZXJTZWxlY3RvciApe1xuICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICAgICAvL3RoaXMgQ1NTIGNsYXNzIHNlbGVjdG9yIGlzIHdoZXJlIHlvdSdsbCBhZGQgdGhlIGNhcmQgZWxlbWVudHNcbiAgICB9XG4gICAgcmVuZGVySXRlbXMoKXtcbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kIHRoYXQgcmVuZGVycyBhbGwgZWxlbWVudHMgb24gdGhlIHBhZ2UsXG4gICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIFxuICAgICAgIH0pO1xuICAgIH1cbiAgICBhZGRJdGVtKGVsZW1lbnQpXG4gICAge1xuICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTsgICAvL3B1YmxpYyBtZXRob2QsIHRha2VzIGEgRE9NIGVsZW1lbnRcbiAgICAgICAgLy9hbmQgYWRkcyBpdCB0byB0aGUgY29udGFpbmVyXG4gICAgfTtcbn1cbiIsImltcG9ydCBQb3BVcCBmcm9tIFwiLi9Qb3BVcC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3BVcFdpdGhJbWFnZSBleHRlbmRzIFBvcFVwIHtcbiAgY29uc3RydWN0b3IocG9wVXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcFVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXdJbWFnZVwiKTtcbiAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy10aXRsZVwiKTsgXG4gICAgXG4gIH1cbiAgb3BlbihkYXRhKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIGlmIChkYXRhKSB7XG4gICAgICB0aGlzLl9pbWFnZS5zcmMgPSBkYXRhLmxpbms7IFxuICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gZGF0YS5uYW1lOyAgXG4gICAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lOyBcbiAgICB9XG4gIH1cbiBcbn1cblxuICBcbi8vc3VwZXIoY2xvc2UpXG4vL3N1cGVyKHNldEV2ZW50TGlzdGVuZXJzKSBcbiAgXG5cblxuLy9leHBvcnQgZGVmYXVsdCBQb3BVcFdpdGhJbWFnZTsiXSwibmFtZXMiOlsic2V0dGluZ3MiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImZvcm1TZWxlY3RvciIsImZvcm1MaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwicHJvZmlsZUJ1dHRvbkVkaXQiLCJxdWVyeVNlbGVjdG9yIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVCdXR0b25BZGQiLCJwcm9maWxlQWRkTW9kYWwiLCJwcm9maWxlRm9ybUFkZCIsInByZXZpZXdJbWFnZU1vZGFsIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0RWxlbWVudHMiLCJBcnJheSIsImZyb20iLCJfc3VibWl0QnV0dG9uIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsbSIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpZCIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiZXZlcnkiLCJpbnB1dCIsInJlc2V0VmFsaWRhdGlvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsImRpc2FibGVkIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJuYW1lIiwibGluayIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkRWxlbWVudCIsIl9oYW5kbGVIZWFydEJ1dHRvbiIsIl9oYW5kbGVUcmFzaEJ1dHRvbiIsInRvZ2dsZSIsIl9nZXRFbGVtZW50IiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkVGl0bGUiLCJjYXJkSW1hZ2UiLCJzcmMiLCJhbHQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnlFc2NhcGUiLCJiaW5kIiwiX2Nsb3NlT3ZlcmxheWJ5Q2xpY2siLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3BVcFdpdGhGb3JtIiwiUG9wVXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wRm9ybSIsIl9wb3BTdWJtaXRCdG4iLCJfcG9wSW5wdXRzIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJwb3BJbnBWYWx1ZXMiLCJ2YWx1ZSIsIl9oYW5kbGVTdWJtaXQiLCJpbnB1dFZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJkYXRhIiwicmVzZXQiLCJmb3JtVmFsaWRhdG9ycyIsInVzZXJpbmZvIiwidXNlck5hbWVTZWxlY3RvciIsImpvYk5hbWVTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsImNyZWF0ZUNhcmQiLCJpdGVtIiwiaGFuZGxlSW1hZ2VDbGljayIsInNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJjYXJkRWxlbWVudCIsInBvcFVwV2l0aEltYWdlIiwicG9wVXBTZWxlY3RvciIsIl9pbWFnZSIsIl9jYXB0aW9uIiwicG9wVXBFZGl0UHJvZmlsZSIsImZvcm1EYXRhIiwicG9wVXBBZGRJdGVtIiwidGl0bGUiLCJuZXdDYXJkIiwiaGFuZGxlQWRkUHJvZmlsZUZvcm1TdWJtaXQiLCJET00iLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=